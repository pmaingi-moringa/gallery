pipeline {
    agent any
    tools {nodejs "node"}
    stages {
        stage ('install npm') { //install npm from shell
            steps{
                sh 'npm install'
            }
        }
        stage ('clone repo') { //clone repo from github
            steps{
                git url: "https://github.com/pmaingi-moringa/gallery.git", branch: "master"
            }
        }
        stage ('run tests') { //run npm test on cloned repo
            steps{ 
                sh 'npm test'
            }
        }
        stage ('Deploy in Heroku') {
            steps{
                echo 'TBD on Heroku'
            }
        }
    }
    post{
        success{
            script{
                slackSend(channel: "testing-ip1", message: "Jenkins pipeline communication success!")
            }
        }
    }
}